<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <h1>JS表单失焦验证</h1>
    <hr>

    <form name="regForm" action="1.php" method="post" onsubmit="return checkForm()">
        <table>
            <tr>
                <td>邮箱: </td>
                <td><input type="text" name="email" onblur="checkEmail()"></td>
                <td id="etab">* 必填项, 请输入常用邮箱</td>
            </tr>
            <tr>
                <td>用户名: </td>
                <td><input type="text" name="user" onblur="checkUser()"></td>
                <td id="utab">* 必填项, 请输入用户名</td>
            </tr><tr>
                <td>密码: </td>
                <td><input type="password" name="pass" onblur="checkPass()"></td>
                <td id="ptab">* 必填项, 请输入常用密码</td>
            </tr>
            <tr>
                <td>确认密码: </td>
                <td><input type="password" name="repass" onblur="checkRepass()"></td>
                <td id="rptab">* 必填项, 请再输入一次常用密码</td>
            </tr>
            <tr>
                <td></td>
                <td><button>提交</button></td>
            </tr>
        </table>
    </form>


    <script>

    function checkEmail() {
        var email = document.regForm.email.value;
        var etab = document.getElementById('etab');
        if (email.match(/^[\w\.-]+@\w+(\.\w+){1,3}$/) == null) {
            etab.innerHTML = '* 邮箱格式不正确';
            etab.style.color = '#f00';
            return  false;
        } else {
            etab.innerHTML = '* 通过验证';
            etab.style.color = '#0a0';
            return  true;
        }
    }

    function checkUser() {
        var user = document.regForm.user.value;
        var utab = document.getElementById('utab');
        if (user.match(/^\w{6,18}$/) == null) {
            utab.innerHTML = '* 用户名格式不正确';
            utab.style.color = '#f00';
            return  false;
        } else {
            utab.innerHTML = '* 通过验证';
            utab.style.color = '#0a0';
            return  true;
        }
    }

    function checkPass() {
        var pass = document.regForm.pass.value;
        var ptab = document.getElementById('ptab');
        if (pass.match(/^\w{6,18}$/) == null) {
            ptab.innerHTML = '* 密码长度不合法';
            ptab.style.color = '#f00';
            return  false;
        } else {
            ptab.innerHTML = '* 通过验证';
            ptab.style.color = '#0a0';
            return  true;
        }
    }

    function checkRepass() {
        var pass = document.regForm.pass.value;
        var repass = document.regForm.repass.value;
        var rptab = document.getElementById('rptab');
        if (pass !== repass) {
            rptab.innerHTML = '* 两次密码不一致';
            rptab.style.color = '#f00';
            return  false;
        } else {
            rptab.innerHTML = '* 通过验证';
            rptab.style.color = '#0a0';
            return  true;
        }
    }

    // 单次验证然后提交时再次验证
    function checkForm() {
        return checkEmail() && checkUser() && checkPass() && checkRepass();
    }

    </script>
</body>
</html>
